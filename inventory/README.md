# 库存盘点系统

## 📋 功能概述

这是原片实时库存系统的独立盘点模块，专为库管和管理员设计，提供完整的库存盘点功能。

## 🎯 主要功能

### 📊 盘点方式
- **PDA扫码盘点**：通过API接口实时同步数据
- **手动录入盘点**：在界面中逐个输入盘点数据  
- **Excel批量导入**：上传表格批量导入盘点数据
- **混合模式**：多种方式并行使用

### 📈 盘点类型
- **全盘**：盘点指定基地的所有在库货物
- **部分盘点**：随机抽取30%的货物进行盘点
- **抽盘**：随机抽取10%的货物进行快速检查

### 🔧 管理功能
- 任务创建、启动、完成、取消
- 实时进度跟踪和状态管理
- 差异分析和报告生成
- 数据导出和历史记录

## 📁 目录结构

```
inventory_check/
├── index.php                    # 盘点系统主页（仪表板）
├── inventory_check.php          # 盘点任务管理控制器
├── inventory_check_list.php     # 任务列表页面
├── inventory_check_create.php   # 创建任务页面
├── inventory_check_view.php     # 任务详情页面
├── inventory_check_report.php   # 盘点报告页面
├── inventory_check_import.php    # Excel导入处理
├── inventory_check_import_form.php  # 导入表单页面
├── inventory_check_import_preview.php # 导入预览页面
├── inventory_check_template.csv # Excel导入模板
├── inventory_check_install.php  # 数据库安装向导
├── header.php                   # 公共头部文件
├── footer.php                   # 公共底部文件
├── README.md                    # 说明文档
└── .htaccess                    # 访问控制配置
```

## 🚀 快速开始

### 1. 安装数据库表
访问：`/inventory/inventory_check_install.php`
点击"开始安装"创建必要的数据表

### 2. 访问盘点系统
- **独立入口**：`/inventory/index.php`
- **后台导航**：通过后台管理系统的"库存盘点"菜单

### 3. 创建盘点任务
1. 点击"创建盘点任务"
2. 选择盘点基地和类型
3. 设置任务名称和说明
4. 点击"创建任务"

### 4. 执行盘点
- **PDA扫码**：使用 API `../api/inventory_check.php`
- **Excel导入**：点击"Excel导入"上传文件
- **手动录入**：在任务详情页面逐个输入

### 5. 查看报告
任务完成后自动生成差异分析报告，支持导出Excel

## 🔐 权限管理

- **管理员**：可访问所有基地的盘点功能
- **库管**：只能访问所管理基地的盘点功能
- **其他用户**：无权访问盘点模块

## 📱 API接口

| 接口 | 功能 | 方法 | 说明 |
|------|------|------|------|
| `list` | 获取任务列表 | GET | 获取当前用户的盘点任务 |
| `get` | 获取任务详情 | GET | 获取指定任务的详细信息 |
| `scan` | 扫码盘点 | POST | 处理单个包的扫码数据 |
| `batch_scan` | 批量扫码 | POST | 批量处理多个包的扫码 |
| `get_package_info` | 获取包信息 | GET | 根据包号获取详细信息 |
| `submit_check` | 手动提交 | POST | 手动录入盘点数据 |
| `sync` | 数据同步 | GET | 同步缓存数据到系统 |

API文档：`../api/inventory_check.html`

## 💡 使用技巧

### 📊 盘点效率优化
- 优先使用PDA扫码，减少录入错误
- 批量导入适合大量数据录入
- 混合使用多种盘点方式

### 🔍 差异分析
- 关注差异较大的原片类型
- 定期进行抽盘验证系统准确性
- 及时调整库存数据确保账实相符

### 📈 数据管理
- 定期备份盘点记录
- 建立盘点流程规范
- 培训操作员正确使用系统

## 🛠️ 技术特点

- **响应式设计**：支持PC和移动端访问
- **实时同步**：PDA扫码数据实时更新
- **安全可靠**：基于角色的权限控制
- **高性能**：优化的数据库查询和缓存
- **易扩展**：模块化设计便于功能扩展

## 📞 技术支持

如有问题或建议，请联系系统管理员。

---

*最后更新：2025-11-29*